{% extends "header.html" %}

{% block tasks %}
  
  
  {{task.render(username) | safe}} 

  <br/>


  	{% if task.getNumberOfComments(task.key().id()) > 0 %}

	  	<div class="container" style="margin-top:50px">
	  		<h3>Comments :</h3>
		  <div class="row clearfix">
		    <div class="col-md-12 column">
		      <div class="row clearfix">
		        
		      </div>
		    </div>
		  </div>
		</div>


		  {% for c in comments %}
		  	{% if c.gettaskid() == task.key().id() %}
		  		{{c.render() | safe}}


		  		<div class="container" style="margin-top:50px">
				  <div class="row clearfix">
				    <div class="col-md-12 column">
				      <div class="row clearfix">
				        <div class="col-md-8 column" style="border-right: solid 1px grey">       	
		        		</div>
		        		<div class="col-md-4 column">
		        			{% if user.username == c.author or user.username == task.author %}

		        				<button class="btn btn-default" type="button" id="deleteComBtn{{c.key().id()}}" name="deleteComBtn">Delete Comment </button>
		        				<form id="deleteComForm{{c.key().id()}}" class="deleteComForm" name="deleteComForm" method="POST" >
		        					<input type='hidden' value="{{ task.key().id() }}" name="task_id"/>
					                <input type='hidden' value="{{ c.key().id() }}" name="comment_id"/>
					                <label> Click the button below if you want to delete it </label> <br>  
					                <button type="submit" class="btn btn-default" value="submit" name="deleteCom">Delete it !</button>                
				              	</form>

		        			{% endif %}		        			
		        		</div>
				      </div>
				      <div class="row clearfix">
				        <hr/>
				      </div>
				    </div>
				  </div>
				</div>

		  	{% endif %}
		  	<script type="text/javascript">
		  	$(document).ready(function(e){
		  		$(document.getElementById("deleteComForm{{ c.key().id() }}")).hide();
		  		$(document.getElementById("deleteComBtn{{ c.key().id() }}")).click(function(e) {
		            if ($(document.getElementById("deleteComForm{{ c.key().id() }}")).is(':hidden')){
		              $(document.getElementById("deleteComForm{{ c.key().id() }}")).show();          
		            }else{
		              $(document.getElementById("deleteComForm{{ c.key().id() }}")).hide();
		            }
		            e.preventDefault();
		        });
		  	});
		  	</script>

		  {% endfor %}

		  

	{% endif %}


{% endblock %}
